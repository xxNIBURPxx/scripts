#Connect exchange online
Connect-ExchangeOnline

#Set group recipient filter (a)
Set-DynamicDistributionGroup -Identity "Broadcast - Pursuit - FlyOver Canada - All Teams" -RecipientFilter {((((RecipientType -eq 'UserMailbox') -and (CustomAttribute4 -like 'ges.intra\_Administrative\Exchange\Pursuit-VTR\FlyOverCanada\LinkedUser-Mailbox*'))) -or (CustomAttribute4 -like 'ges.intra\_Administrative\Exchange\Pursuit-VTR\FlyOverCanada\SeasonalUser-Mailbox*')) -and (-not(CustomAttribute4 -like 'ges.intra\_Administrative\Exchange\Pursuit-VTR\FlyOverCanada\LinkedUser-Mailbox\CAB05\Temporary*')) -and (-not(Name -like 'SystemMailbox{*')) -and (-not(Name -like 'CAS_{*')) -and (-not(RecipientTypeDetailsValue -eq 'MailboxPlan')) -and (-not(RecipientTypeDetailsValue -eq 'DiscoveryMailbox')) -and (-not(RecipientTypeDetailsValue -eq 'PublicFolderMailbox')) -and (-not(RecipientTypeDetailsValue -eq 'ArbitrationMailbox')) -and (-not(RecipientTypeDetailsValue -eq 'AuditLogMailbox')) -and (-not(RecipientTypeDetailsValue -eq 'AuxAuditLogMailbox')) -and (-not(RecipientTypeDetailsValue -eq 'SupervisoryReviewPolicyMailbox')) -and (-not(Name -like 'SystemMailbox{*'))}

#Set group recipient filter (b)
Set-DynamicDistributionGroup -Identity "Broadcast - Pursuit - FlyOver Canada - All Teams" -RecipientFilter {((((RecipientType -eq 'UserMailbox') -and (CustomAttribute4 -like 'ges.intra\_Administrative\Exchange\Pursuit-VTR\FlyOverCanada\LinkedUser-Mailbox*'))) -or (CustomAttribute4 -like 'ges.intra\_Administrative\Exchange\Pursuit-VTR\FlyOverCanada\SeasonalUser-Mailbox*') -and (-not(CustomAttribute4 -like 'ges.intra\_Administrative\Exchange\Pursuit-VTR\FlyOverCanada\LinkedUser-Mailbox\CAB05\Temporary*'))) -and (-not(Name -like 'SystemMailbox{*')) -and (-not(Name -like 'CAS_{*')) -and (-not(RecipientTypeDetailsValue -eq 'MailboxPlan')) -and (-not(RecipientTypeDetailsValue -eq 'DiscoveryMailbox')) -and (-not(RecipientTypeDetailsValue -eq 'PublicFolderMailbox')) -and (-not(RecipientTypeDetailsValue -eq 'ArbitrationMailbox')) -and (-not(RecipientTypeDetailsValue -eq 'AuditLogMailbox')) -and (-not(RecipientTypeDetailsValue -eq 'AuxAuditLogMailbox')) -and (-not(RecipientTypeDetailsValue -eq 'SupervisoryReviewPolicyMailbox')) -and (-not(Name -like 'SystemMailbox{*'))}
